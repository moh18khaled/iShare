import{u as T,r as n,U as A,a as D,b as O,j as e,F as B,c as L,d as _,e as M,f as W,g as S,h as I,i as q,k as G,E as y,l as H,m as R,n as v,o as Y,p as z,L as C,O as J,q as P}from"./index-Bj17gjXj.js";import"https://cdn.socket.io/4.8.1/socket.io.esm.min.js";const r="https://isharee-backend-production.up.railway.app",V=()=>{var h,b;const{id:l}=T(),c=n.useContext(A),F=D(),d=O(),$=F.pathname.includes("/profile/update"),[i,g]=n.useState(!1),[u,k]=n.useState(!1),[s,p]=n.useState({id:0,username:"",email:"",profilePicture:"",postsCount:0,likedPostsCount:0,followersCount:0,followingCount:0,role:"user",mentionedPosts:[],businessName:"",phoneNumber:"",website:"",address:"",businessEmail:"",walletNumber:"",walletType:"",walletAmount:0});n.useEffect(()=>{(async()=>{var o,f,w,j,N;try{const m=l?`${r}/user/${l}`:`${r}/user/account`,x=await P.get(m,{withCredentials:!0});console.log(x.data);const t=l?x.data.user:x.data.data;p({id:t._id||t.id,username:t.username||"",email:t.email,profilePicture:t.profilePicture||"/default-profile.png",postsCount:t.postsCount,likedPostsCount:t.likedPostsCount,followersCount:t.followersCount,followingCount:t.followingCount,walletNumber:t.walletNumber||"",walletType:t.walletType||"",walletAmount:t.walletAmount||0,role:t.role,mentionedPosts:t.mentionedPosts||[],businessName:((o=t.businessDetails)==null?void 0:o.businessName)||"",phoneNumber:((f=t.businessDetails)==null?void 0:f.phoneNumber)||"",website:((w=t.businessDetails)==null?void 0:w.websiteUrl)||"",address:((j=t.businessDetails)==null?void 0:j.address)||"",businessEmail:((N=t.businessDetails)==null?void 0:N.email)||""}),g(t.isFollowed||!1),k(!l||c.auth&&c.auth.id===t._id)}catch(m){console.error("Error fetching user data:",m),d("/profile")}})()},[l,c.auth]);const U=async()=>{try{const a=await P.patch(`${r}/user/${s.id}/toggleFollow`);g(!i),p(o=>({...o,followersCount:i?o.followersCount-1:o.followersCount+1}))}catch(a){console.error("Failed to toggle follow:",a)}},E=a=>{d(`/post/${a}`)};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:`w-full max-w-[100%] md:max-w-[80%] min-h-[calc(100vh+${((h=s.mentionedPosts)==null?void 0:h.length)*50}px)] bg-white rounded-lg shadow-lg p-6 relative`,children:[!$&&e.jsxs(e.Fragment,{children:[!u&&e.jsx("div",{className:"absolute top-4 right-4",children:e.jsxs("button",{onClick:U,className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${i?"bg-gray-300 text-gray-800 hover:bg-gray-400":"bg-blue-500 text-white hover:bg-blue-600"}`,children:[i?e.jsx(B,{}):e.jsx(L,{}),i?"Unfollow":"Follow"]})}),s.role==="businessOwner"&&u&&e.jsx("div",{className:"absolute top-4 right-4",children:e.jsxs("button",{onClick:()=>d("/user/dashboard"),className:"flex items-center gap-2 bg-[#8B4513] text-white px-4 py-2 rounded-lg hover:bg-[#A0522D] transition-colors",children:[e.jsx(_,{}),"Dashboard"]})}),e.jsxs("div",{className:"flex flex-col items-center text-center mt-8",children:[e.jsx("div",{className:"relative",children:e.jsx("img",{className:"w-24 h-24 rounded-full object-cover border-4 border-gray-300",src:s.profilePicture,alt:"Profile"})}),e.jsx("h2",{className:"mt-3 font-semibold text-xl",children:s.username}),s.role==="businessOwner"&&s.businessName&&e.jsxs("div",{className:"flex items-center mt-1 text-gray-600",children:[e.jsx(M,{className:"mr-1"}),e.jsx("span",{children:s.businessName})]})]}),(s.walletNumber||s.walletType)&&e.jsx("div",{className:"mt-6 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[e.jsxs("div",{className:" p-3 rounded-full flex items-center gap-4",children:[e.jsx(W,{className:"text-blue-600 text-xl"}),e.jsxs("p",{children:[s.walletAmount,"$"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"font-semibold text-blue-800",children:"Payment Details"}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-4 mt-2",children:[s.walletType&&e.jsxs("div",{className:"bg-white px-4 py-2 rounded-lg shadow-xs",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Wallet Type"}),e.jsx("p",{className:"font-medium",children:Array.isArray(s.walletType)?s.walletType.join(", "):s.walletType})]}),s.walletNumber&&e.jsxs("div",{className:"bg-white px-4 py-2 rounded-lg shadow-xs",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Wallet Number"}),e.jsx("p",{className:"font-mono font-bold",children:s.walletNumber})]})]})]})]})}),s.role==="businessOwner"&&e.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.phoneNumber&&e.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[e.jsx(S,{className:"text-gray-600 mr-3"}),e.jsx("a",{href:`tel:${s.phoneNumber}`,className:"text-gray-700 hover:text-blue-600",children:s.phoneNumber})]}),s.website&&e.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[e.jsx(I,{className:"text-gray-600 mr-3"}),e.jsx("a",{href:s.website.startsWith("http")?s.website:`https://${s.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-gray-700 hover:text-blue-600 break-all",children:s.website})]}),s.businessEmail&&e.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[e.jsx(q,{className:"text-gray-600 mr-3"}),e.jsx("a",{href:`mailto:${s.businessEmail}`,className:"text-gray-700 hover:text-blue-600 break-all",children:s.businessEmail})]}),s.address&&e.jsxs("div",{className:"flex items-start p-3 bg-gray-50 rounded-lg",children:[e.jsx(G,{className:"text-gray-600 mr-3 mt-1"}),e.jsx("span",{className:"text-gray-700",children:s.address})]})]}),e.jsxs("div",{className:"mt-6 flex justify-between text-center",children:[s.role!=="businessOwner"&&e.jsx(y,{icon:e.jsx(H,{className:"text-2xl text-gray-700 mx-auto"}),title:"Posts",value:s.postsCount,endpoint:l?`${r}/user/${l}/posts`:`${r}/user/account/posts`}),e.jsx(y,{icon:e.jsx(R,{className:"text-2xl text-gray-700 mx-auto"}),title:"Liked Posts",value:s.likedPostsCount,endpoint:l?`${r}/user/${l}/liked-posts`:`${r}/user/account/posts/liked-posts`}),e.jsx(v,{icon:e.jsx(Y,{className:"text-2xl text-gray-700 mx-auto"}),title:"Followers",value:s.followersCount,endpoint:l?`${r}/user/${l}/followers`:`${r}/user/account/followers`}),e.jsx(v,{icon:e.jsx(z,{className:"text-2xl text-gray-700 mx-auto"}),title:"Following",value:s.followingCount,endpoint:l?`${r}/user/${l}/following`:`${r}/user/account/following`})]}),u&&e.jsxs("form",{className:"mt-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Username"}),e.jsx("input",{type:"text",name:"username",value:s.username,readOnly:!0,className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",name:"email",value:s.email,readOnly:!0,className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(C,{to:"/profile/update",className:"flex-grow bg-black text-white py-2 px-4 rounded-lg hover:bg-gray-800 transition text-center",children:"Update Profile"}),e.jsx(C,{to:"/profile/update-password",className:"flex-grow bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition text-center",children:"Update Password"})]})]})]}),s.role==="businessOwner"&&s.mentionedPosts.length!==0&&e.jsxs("div",{className:"flex flex-col min-h-screen p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-center p-4 mb-4",children:"Mentioned Posts"}),e.jsx("div",{className:"flex-grow flex justify-center flex-wrap gap-10",children:(b=s.mentionedPosts)==null?void 0:b.map(a=>e.jsxs("div",{className:"max-w-48 h-auto rounded-lg overflow-hidden shadow-lg bg-white relative group",style:{width:"fit-content"},onClick:()=>E(a._id),children:[a.mediaType==="video"?e.jsxs("video",{className:"w-fit h-full object-cover",controls:!0,children:[e.jsx("source",{src:a.video.url,type:`video/${a.video.url.split(".").pop()}`}),"Your browser does not support the video tag."]}):e.jsx("img",{className:"w-fit h-full object-cover",src:a.image.url,alt:a.title}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all duration-300",children:e.jsx("h2",{className:"text-white text-xl font-bold opacity-0 group-hover:opacity-100 transition-all duration-300",children:a.title})})]},a._id))})]}),e.jsx(J,{})]})})};export{V as default};
